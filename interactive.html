<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Carte concurrentielle â€“ Lâ€™Orange Bleue</title>

<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css">
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<style>
html, body {
  margin: 0;
  height: 100%;
  font-family: Arial, sans-serif;
}

#map {
  height: 100%;
  width: 100%;
}

#info {
  position: fixed;
  bottom: 20px;
  left: 20px;
  background: white;
  padding: 15px;
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.3);
  max-width: 360px;
  display: none;
}

#info h3 {
  margin-top: 0;
  color: #ff6a00;
}

.legend {
  position: fixed;
  top: 20px;
  right: 20px;
  background: white;
  padding: 10px;
  border-radius: 6px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.3);
  font-size: 14px;
}
</style>
</head>

<body>

<div id="map"></div>
<div id="info"></div>

<div class="legend">
  ðŸŸ  Lâ€™Orange Bleue<br>
  ðŸŸ¢ Salle â‰¤ 2 km<br>
  ðŸ”´ Salle > 2 km
</div>

<script>
// ================= ORANGE BLEUE =================
const orangeBleue = {
  name: "Lâ€™Orange Bleue",
  lat: 41.4305,
  lng: 2.1840
};

const map = L.map("map").setView([orangeBleue.lat, orangeBleue.lng], 13);

L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
  attribution: "Â© OpenStreetMap"
}).addTo(map);

// Marqueur Orange Bleue
L.marker([orangeBleue.lat, orangeBleue.lng], {
  icon: L.icon({
    iconUrl: "https://maps.gstatic.com/mapfiles/ms2/micons/orange.png",
    iconSize: [32,32],
    iconAnchor: [16,32]
  })
}).addTo(map).bindPopup("ðŸ‹ï¸ Lâ€™Orange Bleue");

// Cercle 2 km
L.circle([orangeBleue.lat, orangeBleue.lng], {
  radius: 2000,
  color: "#ff6a00",
  fillColor: "#ff6a00",
  fillOpacity: 0.15
}).addTo(map);

// ================= OUTILS =================
function distanceKm(lat, lng) {
  return map.distance(
    [orangeBleue.lat, orangeBleue.lng],
    [lat, lng]
  ) / 1000;
}

const infoBox = document.getElementById("info");

function showInfo(html) {
  infoBox.innerHTML = html;
  infoBox.style.display = "block";
}

// ================= SALLES =================
const gyms = [
  { name:"Club Esports Fabra Gym", lat:41.4335, lng:2.1831, prix:"â‰ˆ 50 â‚¬/mois", type:"Fitness" },
  { name:"Nick Spa & Sport Club", lat:41.4388, lng:2.1864, prix:"77,95 â€“ 99,95 â‚¬", type:"Gym + Spa" },
  { name:"GimnÃ s Sport Club", lat:41.4269, lng:2.1795, prix:"44 â‚¬/mois", type:"Fitness" },
  { name:"Puro Impacto", lat:41.4298, lng:2.1762, prix:"45 â€“ 119 â‚¬", type:"Sports de combat" },
  { name:"VivaGym Meridiana", lat:41.4354, lng:2.1881, prix:"â‰ˆ 29,90 â‚¬", type:"Low-cost" },
  { name:"VivaGym PegÃ s", lat:41.4317, lng:2.1916, prix:"â‰ˆ 29,90 â‚¬", type:"Low-cost" },
  { name:"Entrena-T 24h", lat:41.4361, lng:2.1889, prix:"47,90 â‚¬", type:"24h/24" },
  { name:"Club NataciÃ³ Sant Andreu", lat:41.4359, lng:2.1853, prix:"â‰ˆ 48 â‚¬", type:"Piscine + gym" },
  { name:"Cobosu Gym Station", lat:41.4282, lng:2.1813, prix:"Sur demande", type:"IndÃ©pendant" },
  { name:"CEM GuinardÃ³", lat:41.4188, lng:2.1734, prix:"55,85 â‚¬", type:"Municipal" },
  { name:"DIR AlcÃºdia", lat:41.4381, lng:2.1820, prix:"â‰ˆ 45 â‚¬", type:"Premium" },
  { name:"DIR Maragall", lat:41.4219, lng:2.1730, prix:"â‰ˆ 48 â‚¬", type:"Premium" },
  { name:"Synergym Fabra i Puig", lat:41.4332, lng:2.1819, prix:"â‰ˆ 22 â‚¬", type:"Low-cost" },
  { name:"Synergym Maragall", lat:41.4214, lng:2.1708, prix:"â‰ˆ 23 â‚¬", type:"Low-cost" },
  { name:"CEM Cotxeres BorbÃ³", lat:41.4290, lng:2.1745, prix:"Sur place", type:"Municipal" },
  { name:"Forus Can DragÃ³", lat:41.4323, lng:2.1701, prix:"â‰ˆ 68 â‚¬", type:"Premium" }
];

// ================= MARQUEURS =================
gyms.forEach(gym => {
  const d = distanceKm(gym.lat, gym.lng);
  const inside = d <= 2;

  const icon = L.icon({
    iconUrl: inside
      ? "https://maps.gstatic.com/mapfiles/ms2/micons/green.png"
      : "https://maps.gstatic.com/mapfiles/ms2/micons/red.png",
    iconSize: [28,28],
    iconAnchor: [14,28]
  });

  L.marker([gym.lat, gym.lng], {icon})
    .addTo(map)
    .bindPopup(gym.name)
    .on("click", () => {
      showInfo(`
        <h3>${gym.name}</h3>
        <p><strong>Type :</strong> ${gym.type}</p>
        <p><strong>Prix :</strong> ${gym.prix}</p>
        <p><strong>Distance :</strong> ${d.toFixed(2)} km</p>
        <p><strong>Zone :</strong> ${inside ? "Dans le pÃ©rimÃ¨tre" : "Hors pÃ©rimÃ¨tre"}</p>
      `);
    });
});
</script>

</body>
</html>
