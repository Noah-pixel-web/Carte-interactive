<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Analyse concurrentielle ‚Äì L‚ÄôOrange Bleue</title>

<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css">
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<style>
html, body {
  margin: 0;
  height: 100%;
  font-family: Arial, Helvetica, sans-serif;
}

#map {
  height: 100%;
  width: calc(100% - 480px);
}

#panel {
  position: fixed;
  top: 0;
  right: 0;
  width: 480px;
  height: 100%;
  background: #fff;
  box-shadow: -4px 0 15px rgba(0,0,0,0.25);
  padding: 20px;
  overflow-y: auto;
}

#panel h2 {
  margin-top: 0;
  color: #ff6a00;
}

.badge {
  display: inline-block;
  padding: 6px 10px;
  margin: 5px 5px 5px 0;
  font-size: 12px;
  border-radius: 6px;
  background: #eee;
}

.inside { background: #c8f7c5; }
.outside { background: #f7c5c5; }

table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 15px;
  font-size: 13px;
}

th, td {
  border: 1px solid #ddd;
  padding: 6px;
  vertical-align: top;
}

th {
  background: #ff6a00;
  color: white;
}

#legend {
  position: fixed;
  bottom: 20px;
  left: 20px;
  background: white;
  padding: 12px;
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.3);
  font-size: 14px;
}
</style>
</head>

<body>

<div id="map"></div>
<div id="panel">
  <h2>S√©lectionne une salle</h2>
  <p>Clique sur un marqueur pour afficher toutes les informations.</p>
</div>

<div id="legend">
üü† L‚ÄôOrange Bleue<br>
üü¢ Salle ‚â§ 2 km<br>
üî¥ Salle > 2 km
</div>

<script>
/* ================= PARAM√àTRES ================= */
const ORANGE_BLEUE = { lat: 41.4305, lng: 2.1840 };
const RAYON = 2000;

/* ================= CARTE ================= */
const map = L.map("map").setView([ORANGE_BLEUE.lat, ORANGE_BLEUE.lng], 13);

L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(map);

// Marqueur Orange Bleue
L.marker([ORANGE_BLEUE.lat, ORANGE_BLEUE.lng], {
  icon: L.icon({
    iconUrl: "https://maps.gstatic.com/mapfiles/ms2/micons/orange.png",
    iconSize: [32,32]
  })
}).addTo(map).bindPopup("üèãÔ∏è L‚ÄôOrange Bleue");

L.circle([ORANGE_BLEUE.lat, ORANGE_BLEUE.lng], {
  radius: RAYON,
  color: "#ff6a00",
  fillOpacity: 0.15
}).addTo(map);

/* ================= OUTILS ================= */
function distanceKm(lat, lng) {
  return (map.distance(
    [ORANGE_BLEUE.lat, ORANGE_BLEUE.lng],
    [lat, lng]
  ) / 1000).toFixed(2);
}

function renderOffers(offers) {
  let html = `
    <table>
      <tr>
        <th>Formule</th>
        <th>Prix</th>
        <th>Acc√®s inclus</th>
        <th>Remarques</th>
      </tr>`;
  offers.forEach(o => {
    html += `
      <tr>
        <td>${o.formule}</td>
        <td>${o.prix}</td>
        <td>${o.acces}</td>
        <td>${o.remarque}</td>
      </tr>`;
  });
  html += "</table>";
  return html;
}

/* ================= DONN√âES SALLES ================= */
const gyms = [
{
  name: "Club Esports Fabra Gym",
  lat: 41.4335, lng: 2.1831,
  offers: [
    {formule:"Abonnement mensuel", prix:"‚âà 50 ‚Ç¨ / mois", acces:"Musculation & fitness", remarque:"Tarif indicatif"},
    {formule:"Abonnement trimestriel", prix:"Non communiqu√©", acces:"Idem mensuel", remarque:"√Ä demander"},
    {formule:"Abonnement annuel", prix:"Non communiqu√©", acces:"Acc√®s complet", remarque:"Plus avantageux"},
    {formule:"Frais d‚Äôinscription", prix:"Variable", acces:"Carte + inscription", remarque:"Parfois offerts"},
    {formule:"Cours collectifs", prix:"Inclus / option", acces:"Selon formule", remarque:"√Ä confirmer"},
    {formule:"Acc√®s libre", prix:"Inclus", acces:"Horaires d‚Äôouverture", remarque:""}
  ]
},
{
  name: "Nick Spa & Sport Club",
  lat: 41.4388, lng: 2.1864,
  offers: [
    {formule:"Acc√®s limit√©", prix:"77,95 ‚Ç¨/mois", acces:"Gym + installations", remarque:"Cr√©neaux restreints"},
    {formule:"Acc√®s limit√© (6 mois)", prix:"‚âà 70,16 ‚Ç¨/mois", acces:"M√™me acc√®s", remarque:"Paiement semestriel"},
    {formule:"Acc√®s libre", prix:"99,95 ‚Ç¨/mois", acces:"Gym + spa", remarque:"Full access"},
    {formule:"Acc√®s libre (6 mois)", prix:"‚âà 89,96 ‚Ç¨/mois", acces:"M√™me acc√®s", remarque:"Paiement semestriel"},
    {formule:"Invitations invit√©s", prix:"Inclus", acces:"Jusqu‚Äô√† 3 invit√©s", remarque:"Sur r√©servation"}
  ]
},
{
  name: "Gimn√†s Sport Club",
  lat: 41.4269, lng: 2.1795,
  offers: [
    {formule:"Abonnement mensuel", prix:"44 ‚Ç¨ / mois", acces:"Musculation & fitness", remarque:"Tarif standard"},
    {formule:"Frais d‚Äôinscription", prix:"48 ‚Ç¨", acces:"Carte + ouverture", remarque:"Unique"},
    {formule:"S√©ance ponctuelle", prix:"15 ‚Ç¨", acces:"Entr√©e unique", remarque:"Sans abonnement"}
  ]
},
{
  name: "Puro Impacto",
  lat: 41.4298, lng: 2.1762,
  offers: [
    {formule:"Fitness ‚Äì 1 mois", prix:"45 ‚Ç¨/mois", acces:"Muscu & cardio", remarque:"+ matr√≠cula 50 ‚Ç¨"},
    {formule:"Fitness ‚Äì 12 mois", prix:"‚âà 33,75 ‚Ç¨/mois", acces:"Muscu & cardio", remarque:"Paiement anticip√©"},
    {formule:"Fight Club", prix:"79 ‚Ç¨/mois", acces:"Sports de combat", remarque:"Boxe / MMA"},
    {formule:"Elite Combat", prix:"119,90 ‚Ç¨/mois", acces:"Combat complet", remarque:"Premium"},
    {formule:"Mantenimiento", prix:"15 ‚Ç¨/mois", acces:"Dossier actif", remarque:""}
  ]
},
{
  name: "VivaGym Meridiana",
  lat: 41.4354, lng: 2.1881,
  offers: [
    {formule:"Cuota ONE", prix:"‚âà 29,90 ‚Ç¨/mois", acces:"Club local", remarque:"Sans engagement"},
    {formule:"Cuota FLEX", prix:"‚âà 34,90 ‚Ç¨/mois", acces:"Zone", remarque:"Flexible"},
    {formule:"Cuota PRIME", prix:"‚âà 37 ‚Ç¨/mois", acces:"Tous clubs", remarque:"Premium"},
    {formule:"Pass 1 jour", prix:"‚âà 9‚Äì10 ‚Ç¨", acces:"1 journ√©e", remarque:"Test"}
  ]
},
{
  name: "VivaGym Peg√†s",
  lat: 41.4317, lng: 2.1916,
  offers: [
    {formule:"Cuota ONE", prix:"‚âà 29,90 ‚Ç¨/mois", acces:"Club local", remarque:"Basique"},
    {formule:"Cuota FLEX", prix:"‚âà 34,90 ‚Ç¨/mois", acces:"Zone", remarque:""},
    {formule:"Cuota PRIME", prix:"‚âà 37 ‚Ç¨/mois", acces:"Tous clubs", remarque:""}
  ]
},
{
  name: "Entrena-T 24h Sant Andreu",
  lat: 41.4361, lng: 2.1889,
  offers: [
    {formule:"Cuota mensual", prix:"47,90 ‚Ç¨/mois", acces:"24h/24 ‚Äì 7j/7", remarque:"Sans engagement"},
    {formule:"Cuota ahorro", prix:"39,92 ‚Ç¨/mois", acces:"Acc√®s complet", remarque:"Pr√©pay√©"},
    {formule:"Promo mensuelle", prix:"‚âà 7,18 ‚Ç¨", acces:"Acc√®s complet", remarque:"Offre ponctuelle"}
  ]
},
{
  name: "Club Nataci√≥ Sant Andreu",
  lat: 41.4359, lng: 2.1853,
  offers: [
    {formule:"Abonnement mensuel", prix:"‚âà 48,80 ‚Ç¨", acces:"Piscine + gym", remarque:""},
    {formule:"Entr√©e ponctuelle", prix:"‚âà 7,40 ‚Ç¨", acces:"1 journ√©e", remarque:""},
    {formule:"Soci juvenil", prix:"‚âà 32,91 ‚Ç¨", acces:"Installations", remarque:"Jeunes"}
  ]
},
{
  name: "Cobosu Gym Station",
  lat: 41.4282, lng: 2.1813,
  offers: [
    {formule:"Tarifs", prix:"Non publi√©s", acces:"‚Äî", remarque:"Contact direct"}
  ]
},
{
  name: "CEM Guinard√≥",
  lat: 41.4188, lng: 2.1734,
  offers: [
    {formule:"Quota Adult", prix:"55,85 ‚Ç¨/mois", acces:"Piscine + fitness", remarque:""},
    {formule:"Quota Jove", prix:"43,85 ‚Ç¨/mois", acces:"Acc√®s complet", remarque:""},
    {formule:"Quota Senior", prix:"34,86 ‚Ç¨/mois", acces:"Acc√®s complet", remarque:""}
  ]
}
];

/* ================= MARQUEURS ================= */
gyms.forEach(gym => {
  const d = distanceKm(gym.lat, gym.lng);
  const inside = d <= 2;

  const iconUrl = inside
    ? "https://maps.gstatic.com/mapfiles/ms2/micons/green.png"
    : "https://maps.gstatic.com/mapfiles/ms2/micons/red.png";

  L.marker([gym.lat, gym.lng], {
    icon: L.icon({ iconUrl, iconSize:[28,28] })
  })
  .addTo(map)
  .on("click", () => {
    document.getElementById("panel").innerHTML = `
      <h2>${gym.name}</h2>
      <span class="badge ${inside ? "inside" : "outside"}">
        ${inside ? "Dans le p√©rim√®tre (‚â§ 2 km)" : "Hors p√©rim√®tre (> 2 km)"}
      </span>
      <p><strong>Distance :</strong> ${d} km</p>
      ${renderOffers(gym.offers)}
    `;
  });
});
</script>

</body>
</html>
