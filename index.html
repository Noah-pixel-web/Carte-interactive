<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Analyse concurrentielle ‚Äì L‚ÄôOrange Bleue</title>

<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css">
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<style>
html, body {
  margin: 0;
  height: 100%;
  font-family: Arial, sans-serif;
}

#map {
  height: 100%;
  width: 100%;
}

#info {
  position: fixed;
  bottom: 20px;
  left: 20px;
  background: white;
  padding: 15px;
  border-radius: 10px;
  box-shadow: 0 2px 10px rgba(0,0,0,0.3);
  max-width: 420px;
  max-height: 70%;
  overflow-y: auto;
  display: none;
}

#info h3 {
  margin-top: 0;
  color: #ff6a00;
}

#info table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 10px;
  font-size: 14px;
}

#info th, #info td {
  border: 1px solid #ddd;
  padding: 6px;
}

#info th {
  background: #ff6a00;
  color: white;
}

.legend {
  position: fixed;
  top: 20px;
  right: 20px;
  background: white;
  padding: 10px;
  border-radius: 6px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.3);
  font-size: 14px;
}
</style>
</head>

<body>

<div id="map"></div>
<div id="info"></div>

<div class="legend">
üü† L‚ÄôOrange Bleue<br>
üü¢ Concurrent ‚â§ 2 km<br>
üî¥ Concurrent > 2 km
</div>

<script>
// ================= ORANGE BLEUE =================
const orangeBleue = { lat: 41.4305, lng: 2.1840 };

const map = L.map("map").setView([orangeBleue.lat, orangeBleue.lng], 13);

L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
  attribution: "¬© OpenStreetMap"
}).addTo(map);

L.marker([orangeBleue.lat, orangeBleue.lng], {
  icon: L.icon({
    iconUrl: "https://maps.gstatic.com/mapfiles/ms2/micons/orange.png",
    iconSize: [32,32],
    iconAnchor: [16,32]
  })
}).addTo(map).bindPopup("üèãÔ∏è L‚ÄôOrange Bleue");

L.circle([orangeBleue.lat, orangeBleue.lng], {
  radius: 2000,
  color: "#ff6a00",
  fillColor: "#ff6a00",
  fillOpacity: 0.15
}).addTo(map);

// ================= OUTILS =================
function distanceKm(lat, lng) {
  return map.distance([orangeBleue.lat, orangeBleue.lng], [lat, lng]) / 1000;
}

const infoBox = document.getElementById("info");

function showInfo(html) {
  infoBox.innerHTML = html;
  infoBox.style.display = "block";
}

// ================= SALLES =================
const gyms = [
{
  name: "Club Esports Fabra Gym",
  lat: 41.4335,
  lng: 2.1831,
  details: `
  <h3>Club Esports Fabra Gym</h3>
  <p><strong>Type :</strong> Salle ind√©pendante</p>
  <p><strong>Distance :</strong> {{DIST}} km</p>
  <table>
    <tr><th>Formule</th><th>Prix</th><th>Acc√®s</th><th>Remarques</th></tr>
    <tr><td>Mensuel</td><td>‚âà 50 ‚Ç¨</td><td>Musculation & fitness</td><td>Standard</td></tr>
    <tr><td>Annuel</td><td>Non communiqu√©</td><td>Complet</td><td>Avantageux</td></tr>
  </table>`
},
{
  name: "Nick Spa & Sport Club",
  lat: 41.4388,
  lng: 2.1864,
  details: `
  <h3>Nick Spa & Sport Club</h3>
  <p><strong>Type :</strong> Premium / Spa</p>
  <p><strong>Distance :</strong> {{DIST}} km</p>
  <table>
    <tr><th>Formule</th><th>Prix</th><th>Acc√®s</th><th>Remarques</th></tr>
    <tr><td>Acc√®s limit√©</td><td>77,95 ‚Ç¨</td><td>Gym + Spa</td><td>Horaires restreints</td></tr>
    <tr><td>Acc√®s libre</td><td>99,95 ‚Ç¨</td><td>Tout inclus</td><td>Premium</td></tr>
  </table>`
},
{
  name: "VivaGym Meridiana",
  lat: 41.4354,
  lng: 2.1881,
  details: `
  <h3>VivaGym Meridiana</h3>
  <p><strong>Type :</strong> Low-cost</p>
  <p><strong>Distance :</strong> {{DIST}} km</p>
  <table>
    <tr><th>Plan</th><th>Prix</th><th>Acc√®s</th><th>Remarques</th></tr>
    <tr><td>ONE</td><td>29,90 ‚Ç¨</td><td>Club local</td><td>Sans engagement</td></tr>
  </table>`
},
{
  name: "Puro Impacto",
  lat: 41.4298,
  lng: 2.1762,
  details: `
  <h3>Puro Impacto</h3>
  <p><strong>Type :</strong> Sports de combat</p>
  <p><strong>Distance :</strong> {{DIST}} km</p>
  <table>
    <tr><th>Pack</th><th>Prix</th><th>Acc√®s</th><th>Remarques</th></tr>
    <tr><td>Fitness</td><td>45 ‚Ç¨</td><td>Muscu</td><td>+ inscription</td></tr>
    <tr><td>Fight Club</td><td>79 ‚Ç¨</td><td>Boxe / MMA</td><td>Sp√©cialis√©</td></tr>
  </table>`
}
];

// ================= MARQUEURS =================
gyms.forEach(gym => {
  const d = distanceKm(gym.lat, gym.lng);
  const inside = d <= 2;

  const icon = L.icon({
    iconUrl: inside
      ? "https://maps.gstatic.com/mapfiles/ms2/micons/green.png"
      : "https://maps.gstatic.com/mapfiles/ms2/micons/red.png",
    iconSize: [28,28],
    iconAnchor: [14,28]
  });

  L.marker([gym.lat, gym.lng], { icon })
    .addTo(map)
    .on("click", () => {
      showInfo(
        gym.details.replace("{{DIST}}", d.toFixed(2)) +
        `<p><strong>Zone :</strong> ${inside ? "Dans le p√©rim√®tre (‚â§ 2 km)" : "Hors p√©rim√®tre (> 2 km)"}</p>`
      );
    });
});
</script>

</body>
</html>
